% xpoints = 0:1:10; % X position of the control points
[xpoints,ypoints] = meshgrid(0:1:10,0:0.25:1);

zpoints_v2 = zeros(5,11)

% These are the design varriables. The optimizer controls these  z heights
%zpoints = 0:17
%zpoints = peaks(xpoints,ypoints);

% Version 6 of the FEA, not incorporates a 2D level set function with
% control points. 
% These results don't make since
% cost =  0.7075, displacement =  -0.0598
% zpoints = [0	0.21477	-0.48579	0.3645	0.14652	-1.49853	0	1.5	1.49118	-1.5	-1.49997	-1.37463	0	-0.58404	-1.5	-1.5	-1.5	-1.49526]
%zpoints = [0	-0.0582	-1.49454	-1.25691	0.71418	-0.17763	0	0.23877	1.48683	-1.49901	-1.38378	-1.48146	0	0.24381	-1.5	0.96102	-1.5	-1.49943]

%  cost = 0.7241
% zpoints = [0	-0.22998	-1.5	-1.26456	0.69342	-0.95175	0	0.91005	1.48431	-0.80916	-1.42056	-1.47864	0	0.15123	-1.5	0.85854	-1.4427	-1.49997]
% zpoints = [ 0	-0.01761	-1.5	-1.5	-0.12588	-1.0698	0	0.76488	1.48953	-1.36128	-1.45662	-1.5	0	-0.34083	-1.49922	0.89559	-1.4997	-1.2336]
% zpoints = ones(1,55);

% Wrapper version 5
% FEA version 7

% after 2500 evaluations and 50 generations
% cost = 0.5173
%zpoints = [0.10689	0.64314	0.70731	-0.27855	-1.5	-1.31067	-0.45423	-0.52377	-0.43743	-1.03323	-0.2049	-0.04854	-0.01329	-0.18558	0.55965	0.62553	0.18225	-0.31614	-0.30015	-1.02867	-0.53433	-0.88878	-1.49964	1.04412	0.78072	-0.38154	0.04917	-0.33039	-0.02682	-0.33582	0.57312	-1.38972	0.60729	0.18489	1.27056	0.4704	0.31509	0.47898	-0.26517	-0.85263	-1.44156	-1.48608	-1.27854	-0.52986	0.23031	-1.27836	-0.05139	-1.43739	-1.39227	0.82536	-0.83418	0.94839	-0.98382	-1.15284	0.54333]

% using the best 45 of the previous optimization as the starting points, I
% continued the optimization with another 2500 evalutions
% zpoitns = [0.22665	0.45216	0.59526	-0.21777	-1.29612	-1.34484	-0.32403	-1.19616	-0.2445	-0.99195	-0.10563	-0.03651	0.03072	-0.17304	0.47913	0.56436	0.19569	-0.53937	-0.06246	-1.05588	-0.60489	-0.86127	-1.40427	0.59298	0.32502	-0.39462	0.07431	-0.30453	-0.05001	-0.33432	-0.78867	-1.36527	0.66441	0.12276	1.08648	0.2367	0.25968	0.49137	-0.32166	-0.69804	-0.94239	-1.49202	-1.27098	-0.60717	-0.23262	-1.05378	-0.23595	-1.48905	-1.5	0.6651	-0.92562	-0.26028	-1.02078	-1.03275	0.60843]

% then I continued the optimization using BBFGS which didn't work. So I
% went back to MOGA2 with more mutations. 
zpoints = [ 0.40671	0.23865	0.52044	-0.15945	-1.25181	-1.42623	-0.10002	-0.80364	-0.72207	-1.10856	-0.18813	-0.03819	0.02271	-0.13383	0.45363	0.55449	0.02427	-0.69591	-0.14022	-1.10046	-0.56649	-1.00671	-1.26057	0.58848	0.2847	-0.4308	0.02832	-0.44166	-0.03693	-0.35625	-1.32675	-1.35687	0.62493	0.01125	1.09884	0.14595	0.26664	0.46449	-0.28599	-0.7326	-0.92916	-1.47702	-1.31127	-0.71127	-0.18636	-1.03698	-0.33162	-1.49571	-1.5	0.64182	-0.93726	-0.16728	-1.04703	-1.5	0.32868]

zpoints = [2.8518,-2.1489,-0.38879,-0.15769,0.55866,-0.25676,-1.275,-2.1244,-0.84512,-2.3627,-0.41001,-2.1177,1.268,0.23943,0.058524,-0.12654,-0.073125,-1.329,-2.4534,-0.98864,0.0029933,-1.27,-0.76682,-2.1915,-0.13384,-0.10662,0.15458,-1.599,-0.46721,-0.33174,-0.21195,-1.2717,-0.91142,0.28113,1.74,0.61853,0.33097,0.25783,1.61,-2.5451,-0.56198,-1.301,-0.27471,-1.0469,-0.27962,-2.85,-0.55378,-0.71501,-0.1773,-2.5782,-0.18112,-0.25454,-0.38793,-0.7672,-0.019956]

zpoints_v2(1,:) = zpoints(1:11)
zpoints_v2(2,:) = zpoints(12:22)
zpoints_v2(3,:) = zpoints(23:33)
zpoints_v2(4,:) = zpoints(34:44)
zpoints_v2(5,:) = zpoints(45:55)
doplot = 1;
[ydisplacment, cost,maxDisplacement] = FEALevelSet_2D_v7(xpoints,ypoints,zpoints_v2, doplot) % Call FEA for first time

