function [obj, cinequality] = FEALevelSetWrapperGA_v2(zpoints)

[xpoints,ypoints] = meshgrid(0:0.5:6,0:0.5:2); 
zpoints_v2 = xpoints;
[xdim, ydim] = size(zpoints_v2);


 %zpoints = [0.88564,0.87801,0.19888,0.99926,0.58114,0.9267,0.98697,0.98855,0.98715,0.99791,-0.00020904,-0.77478,-0.86254,-0.79403,-0.94306,-0.60567,-0.84454,0.95515,-0.039918,-0.39113,-0.77063,-0.54174,-0.42951,-0.64096,-0.50736,-0.528,-0.85935,0.49363,-0.46684,-0.95031,-0.83302,-0.55248,-0.45001,-0.17243,-0.44986,-0.44418,-0.075676,0.96908,-0.8129,-0.70698,-0.69448,-0.39489,-0.49969,-0.3296,0.99873,0.99998,0.99998,0.98501,-0.91432,-0.151,-0.79768,-0.23579,-0.62175,-0.18284,-0.45696];

%zpoints = ones(1,xdim*ydim)*1.1;
doplot = 1;

% zpoints = [-0.78438,-0.8,0.2,-0.8,-0.8,-0.8,-0.8,-0.8,-0.8,-0.8,-0.76875,0.2,0.2,0.2,-0.8,-0.8,0.2,-0.8,-0.8,0.2,0.2,0.2,0.2,0.2,-0.8,0.2,-0.8,0.2,0.15,-0.8,0.2,0.2,-0.8,-0.8,0.2,-0.8,-0.8,-0.8,0.2,-0.75703,0.24688,0.2,-0.8,0.2,-0.8,0.2,-0.8,-0.8,0.2,0.2,0.2,0.20928,-0.8,0.2,-0.8,0.2,0.2,0.2,0.2,0.2,-0.8,-0.8,-0.8,0.2,0.2]
%zpoints = [0.10159,0.2,0.20739,0.325,-0.89121,-0.9,0.2,0.25859,-0.14902,0.21074,0.2022,0.1,0.2,0.225,-0.9,-0.9,0.15,0.325,-0.55,0.07832,-0.8,0.25121,0.15,-0.9,0.1,-0.3625,0.2,0.1,-0.8,-0.89652,0.33043,0.17695,0.2625,-0.3,0.20232,0.16758,-0.89316,0.05,-0.3,0.2,0.2,0.1,0.325,0.2,0.1,0.067761,0.7,0.05,-0.3,0.05,0.2,0.08125,0.15,0.60781,0.2,0.3375,-0.9,0.16563,0.2,0.1,0.29375,0.20391,-0.9,0.21294,0.1]
% zpoints = [ 0.45,0.2,0.7,0.825,-0.8,0.6625,-0.8,0.2,0.2,0.29375,0.2,-0.7375,0.5125,0.7,-0.65,0.2,-0.3,0.96562,0.95,0.7,0.95,0.45,0.45,-0.3,0.2,0.2,-0.8,0.2,0.825,-0.3,-0.8,0.7,0.3875,0.45,0.95,0.49688,0.71562,0.2,-0.3,0.2,0.7,0.45,0.95,0.45,-0.7375,-0.55,0.7,-0.6125,0.45,0.325,0.3875,0.1375,0.45,0.61562,-0.2375,-0.3,0.3875,0.9,0.7,0.6,-0.6125,0.45,0.6375,-0.55,0.45]
% zpoints = [1,1,1,1,1,1,1,1,0.99922,1,1,0.95537,-0.20585,1,1,1,1,1,-0.34797,-0.10306,-0.47107,-0.95955,-0.66667,-0.66667,-0.72215,-0.7576,1,1,1,1,1,-0.87916,-0.82789,-0.65625,-0.45104,-0.77331,-0.48618,-0.16677,-0.82723,1,1,1,1,1,-0.6667,-0.67376,-0.32874,-0.10468,-0.40824,-0.68183,-0.44896,-0.48021,1,1,1,1,1,-0.66671,-0.39433,-0.4564,-0.046188,-0.69872,-0.62582,-0.21006,-0.62913]
zpoints = [ 0.82479,0.94609,0.35954,0.41888,0.24264,-0.3082,-0.035487,0.092613,0.10917,0.23369,0.57749,-0.95916,0.54937,0.17503,-0.15563,-0.61493,-0.55448,0.15822,0.21424,0.17112,0.59326,-0.83279,-0.86068,-0.53234,0.90801,0.25783,0.22591,-0.76876,-0.77455,-0.88054,-0.77349,-0.83555,-0.78579,0.33928,-0.67952,0.33069,0.1327,-0.13713,-0.54119,0.035153,0.43241,0.69721,0.64802,0.47451,0.084133,0.68886,0.20588,0.27011,-0.0060346,-0.53999,-0.02188,-0.77202,0.0022873,-0.16982,-0.56825,-0.76333,-0.35291,-0.050669,-0.74531,-0.99236,-0.83895,-0.37916,-0.89709,-0.67081,-0.72889
]
count = 1;
for i = 1:xdim
    zpoints_v2(i,:) = zpoints(count:ydim+count-1);
    count = count + ydim;  
end




[maxVonMisesStress, cost,maxDisplacement] = FEALevelSet_2D_v8(xpoints,ypoints,zpoints_v2, doplot); % Call FEA for first time

obj = cost
cinequality = [maxVonMisesStress-1000,maxDisplacement-0.5] ;  % max Stress is 1000 psi, max displacement = 0.5
% cequality = ydisplacment+0.0623; % displacement will be negative, so add 0.0623 to make = 0
%feature('GetPid')





