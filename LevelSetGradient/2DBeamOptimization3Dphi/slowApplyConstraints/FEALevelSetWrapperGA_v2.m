function [obj, cinequality] = FEALevelSetWrapperGA_v2(zpoints)

[xpoints,ypoints] = meshgrid(0:0.5:6,0:0.5:2); 
zpoints_v2 = xpoints;
[xdim, ydim] = size(zpoints_v2);


if(zpoints ==1)
    zpoints = ones(1,xdim*ydim)*1.1;
    % zpoints = [0.53767,1,-1,0.86217,0.31877,-1,-0.43359,0.34262,1,1,-1,1,0.7254,-0.063055,0.71474,-0.20497,-0.12414,1,1,1,0.6715,-1,0.71724,1,0.48889,1,0.72689,-0.30344,0.29387,-0.78728,0.8884,-1,-1,-0.8095,-1,1,0.32519,-0.75493,1,-1,-0.10224,-0.24145,0.31921,0.31286,-0.86488,-0.030051,-0.16488,0.62771,1,1,-0.86365,0.077359,-1,-1,-0.0068493,1,-0.76967,0.37138,-0.22558,1,-1,0.032557,0.55253,1,1]
    % zpoints = [ 0.59707,0.57584,0.1,0.12539,0.1875,0.56948,0.45,0.1,0.45,0.7,0.45,0.70327,-0.05,-0.4,-0.50036,0.1,0.1,0.11563,-0.82878,-0.19513,0.18995,-0.97804,-0.89227,0.32353,-0.2,-0.001341,0.52886,-0.089062,0.1,-0.5563,-0.9,-0.62044,-0.8141,0.1,0.6,0.6,-0.0053513,-0.99429,-0.4,0.77578,0.93438,0.17813,-0.15,0.16823,0.39297,0.6,0.95,-0.64902,-0.82018,-0.39414,-0.45223,-0.93101,-0.05,-0.55,0.60317,0.95,-0.040442,-0.69433,-0.85604,-0.9,-0.38438,-0.49533,-0.81483,-0.9,-0.4]
    % zpoints = [0.98148,0.89601,0.31855,0.175,0.17901,0.37627,0.3,0.45,0.3,0.40391,-0.85,-0.50813,0.30195,0.99434,0.3484,0.34688,-0.35863,-0.42019,-0.95716,-0.85,0.4,-0.13365,-0.0625,0.3,0.175,-0.032591,0.49926,-0.825,-0.375,0.9625,0.45625,-0.12578,-0.12199,0.05,-0.6136,-0.34497,-0.6616,0.23992,-0.2,0.65018,0.3,0.35963,0.99199,0.95957,0.83223,0.8596,0.20186,0.096944,0.10697,0.39473,-0.074817,-0.7,-0.15452,-0.41289,-0.24687,-0.67949,-0.78371,-0.55542,-0.57469,-0.31985,-0.19219,-0.76962,-0.60989,-0.090578,-0.53462]
    % zpoints = [0.28884,0.49063,0.74902,0.96461,-0.64377,0.0625,0,0.12143,0.18181,0.9,-0.38262,-0.99081,0.58748,-0.3611,0.23496,0.23589,-0.53875,0.75,0.38672,-0.814,-0.5,-0.64158,-0.79149,0.375,0.89435,-0.31356,-0.25,0.11572,-0.47771,-0.97115,-0.94086,0.29004,-0.75603,-0.85729,-0.5688,-0.75908,-0.68917,0.5,-0.76176,0.90955,-0.26658,-0.34899,-0.52406,-0.25,0.8125,0.75,0.40302,-0.14219,0.43562,0.5,0.15434,-0.92981,-0.225,0.25,0.41147,0.51074,0.21839,-0.14658,-0.0039062,-0.0074274,0.85888,-0.65872,-0.76342,-0.82665,-0.41016]
    % zpoints = [ 0.11758,0.086856,0.055835,0.311,0.27724,0.12245,-0.77886,-0.79637,-0.044124,-0.42485,-0.33618,0.095222,-0.0038953,-0.84951,-0.98588,0.16486,-0.91275,-0.075034,0.087437,0.04992,0.14994,0.14995,0.78894,0.26656,0.14994,-0.48812,-0.14132,-0.82022,0.10454,-0.82455,-0.57025,-0.84951,-0.91288,0.46945,-0.025694,-0.6299,-0.88361,-0.7407,-0.44956,0.54809,-0.13889,0.034721,-0.47579,0.11833,0.17396,0.17162,0.16197,-0.71809,-0.84951,-0.33898,-0.38374,-0.0376,0.70949,0.33714,0.15772,0.518,-0.071842,-0.24919,-0.34934,-0.89467,-0.7871,-0.7661,-0.77149,-0.84951,-0.81467]
    zpoints = [0.11758,0.086856,0.055835,0.311,0.27724,0.12245,-0.77886,-0.79637,-0.044124,-0.42485,-0.33618,0.095222,-0.0038953,-0.84951,-0.98588,0.16486,-0.91275,-0.075034,0.087437,0.04992,0.14994,0.14995,0.78894,0.26656,0.14994,-0.48812,-0.14132,-0.82022,0.10454,-0.82455,-0.57025,-0.84951,-0.91288,0.46945,-0.025694,-0.6299,-0.88361,-0.7407,-0.44956,0.54809,-0.13889,0.034721,-0.47579,0.11833,0.17396,0.17162,0.16197,-0.71809,-0.84951,-0.33898,-0.38374,-0.0376,0.70949,0.33714,0.15772,0.518,-0.071842,-0.24919,-0.34934,-0.89467,-0.7871,-0.7661,-0.77149,-0.84951,-0.81467]


    doplot = 1;
    
    
else
    doplot = 0;
end


count = 1;
for i = 1:xdim
    zpoints_v2(i,:) = zpoints(count:ydim+count-1);
    count = count + ydim;  
end

% doplot = 1;



[maxVonMisesStress, cost,maxDisplacement,strainEnergy] = FEALevelSet_2D_v8(xpoints,ypoints,zpoints_v2, doplot); % Call FEA for first time

% vonMises Stress
% 585.1768 = solid = min, 
% 3000=  max
normalizedStress = (maxVonMisesStress-585)/(3000-585);
normalizedCost = cost;

weightCost = 0.5;
weightStress = 0.5;

obj = strainEnergy;

% obj = normalizedStress*weightStress  +   normalizedCost*weightCost % mininimize vonMisesStress, 
cinequality = [cost] ;  % sstress must be below 3000, max dipslacement below 0.3
% cequality = ydisplacment+0.0623; % displacement will be negative, so add 0.0623 to make = 0
%feature('GetPid')
fprintf('Strain E  = %f and cost = %f \n',strainEnergy, cost)




